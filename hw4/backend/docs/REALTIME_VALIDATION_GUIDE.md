# 即時表單驗證測試指南

## 📋 功能說明

已實作**即時欄位驗證**功能，當使用者填完任何一個欄位並離開（blur/untoggle）時，會立即在該欄位下方顯示驗證錯誤訊息（如果有的話）。

### ✨ 主要特點

1. **即時反饋**：使用者無需提交表單即可知道輸入是否正確
2. **欄位級錯誤**：每個欄位獨立顯示錯誤訊息
3. **智能清除**：當使用者重新輸入時，錯誤訊息自動消失
4. **視覺提示**：錯誤欄位會顯示紅色邊框和錯誤圖示
5. **友善提示**：正常狀態下也有格式說明文字

---

## 🧪 測試場景

### **場景 1：登入頁面 - Email 格式驗證**

#### 操作步驟：
1. 訪問登入頁面 `http://localhost:5173/login`
2. 點擊「電子郵件」欄位
3. 輸入：`invalidemail`（沒有 @ 符號）
4. 按 Tab 或點擊其他地方（讓欄位失去焦點）

#### 預期結果：
```
❌ 電子郵件欄位下方顯示：
   "請提供有效的電子郵件地址"
   欄位邊框變成紅色
```

#### 後續操作：
5. 重新點擊「電子郵件」欄位
6. 修改為：`test@example.com`

#### 預期結果：
```
✅ 錯誤訊息立即消失
   欄位邊框恢復正常
```

---

### **場景 2：登入頁面 - 密碼空值驗證**

#### 操作步驟：
1. 點擊「密碼」欄位
2. 不輸入任何內容
3. 按 Tab 或點擊其他地方

#### 預期結果：
```
❌ 密碼欄位下方顯示：
   "密碼不能為空"
   欄位邊框變成紅色
```

---

### **場景 3：註冊頁面 - 使用者名稱長度驗證**

#### 操作步驟：
1. 訪問註冊頁面 `http://localhost:5173/register`
2. 點擊「使用者名稱」欄位
3. 輸入：`ab`（少於 3 個字元）
4. 按 Tab 或點擊其他地方

#### 預期結果：
```
❌ 使用者名稱欄位下方顯示：
   "使用者名稱長度必須在 3-50 個字元之間"
   欄位邊框變成紅色
```

#### 正常狀態：
```
ℹ️  當欄位沒有錯誤時，下方顯示提示：
   "3-50 個字元，只能包含字母、數字和底線"
   欄位邊框為正常藍色
```

---

### **場景 4：註冊頁面 - 使用者名稱格式驗證**

#### 操作步驟：
1. 點擊「使用者名稱」欄位
2. 輸入：`test-user`（包含連字號）
3. 按 Tab 或點擊其他地方

#### 預期結果：
```
❌ 使用者名稱欄位下方顯示：
   "使用者名稱只能包含字母、數字和底線"
   欄位邊框變成紅色
```

---

### **場景 5：註冊頁面 - Email 格式驗證**

#### 操作步驟：
1. 點擊「電子郵件」欄位
2. 輸入：`notanemail`（沒有 @ 和域名）
3. 按 Tab 或點擊其他地方

#### 預期結果：
```
❌ 電子郵件欄位下方顯示：
   "請提供有效的電子郵件地址"
   欄位邊框變成紅色
```

---

### **場景 6：註冊頁面 - 密碼長度驗證**

#### 操作步驟：
1. 點擊「密碼」欄位
2. 輸入：`Test@12`（少於 8 個字元）
3. 按 Tab 或點擊其他地方

#### 預期結果：
```
❌ 密碼欄位下方顯示：
   "密碼長度至少需要 8 個字元"
   欄位邊框變成紅色
```

#### 正常狀態：
```
ℹ️  當欄位沒有錯誤時，下方顯示提示：
   "至少 8 個字元，包含大小寫字母、數字和特殊字元"
   欄位邊框為正常藍色
```

---

### **場景 7：註冊頁面 - 密碼缺少大寫字母**

#### 操作步驟：
1. 點擊「密碼」欄位
2. 輸入：`test@1234`（沒有大寫字母）
3. 按 Tab 或點擊其他地方

#### 預期結果：
```
❌ 密碼欄位下方顯示：
   "密碼必須包含至少一個大寫字母"
   欄位邊框變成紅色
```

---

### **場景 8：註冊頁面 - 密碼缺少小寫字母**

#### 操作步驟：
1. 點擊「密碼」欄位
2. 輸入：`TEST@1234`（沒有小寫字母）
3. 按 Tab 或點擊其他地方

#### 預期結果：
```
❌ 密碼欄位下方顯示：
   "密碼必須包含至少一個小寫字母"
   欄位邊框變成紅色
```

---

### **場景 9：註冊頁面 - 密碼缺少數字**

#### 操作步驟：
1. 點擊「密碼」欄位
2. 輸入：`Test@abcd`（沒有數字）
3. 按 Tab 或點擊其他地方

#### 預期結果：
```
❌ 密碼欄位下方顯示：
   "密碼必須包含至少一個數字"
   欄位邊框變成紅色
```

---

### **場景 10：註冊頁面 - 密碼缺少特殊字元**

#### 操作步驟：
1. 點擊「密碼」欄位
2. 輸入：`Test1234`（沒有特殊字元）
3. 按 Tab 或點擊其他地方

#### 預期結果：
```
❌ 密碼欄位下方顯示：
   "密碼必須包含至少一個特殊字元 (@$!%*?&)"
   欄位邊框變成紅色
```

---

### **場景 11：註冊頁面 - 確認密碼不一致**

#### 操作步驟：
1. 在「密碼」欄位輸入：`Test@1234`
2. 在「確認密碼」欄位輸入：`Test@5678`
3. 按 Tab 或點擊其他地方

#### 預期結果：
```
❌ 確認密碼欄位下方顯示：
   "密碼確認不一致"
   欄位邊框變成紅色
```

---

### **場景 12：註冊頁面 - 確認密碼為空**

#### 操作步驟：
1. 在「密碼」欄位輸入：`Test@1234`
2. 點擊「確認密碼」欄位但不輸入任何內容
3. 按 Tab 或點擊其他地方

#### 預期結果：
```
❌ 確認密碼欄位下方顯示：
   "請確認密碼"
   欄位邊框變成紅色
```

---

### **場景 13：完整註冊流程 - 逐欄驗證**

#### 操作步驟：
1. 依序填寫每個欄位，每填完一個就按 Tab 跳到下一個：
   - 使用者名稱：`testuser123`
   - 電子郵件：`test@example.com`
   - 密碼：`Test@1234`
   - 確認密碼：`Test@1234`

#### 預期結果：
```
✅ 所有欄位都不顯示錯誤訊息
   所有欄位邊框都是正常顏色
   使用者名稱和密碼下方顯示灰色提示文字
   可以正常提交註冊
```

---

### **場景 14：錯誤訊息的即時清除**

#### 操作步驟：
1. 在「使用者名稱」欄位輸入：`ab`（觸發錯誤）
2. 離開欄位（會顯示錯誤）
3. 重新點擊「使用者名稱」欄位
4. 開始輸入新的字元（例如輸入 `c`，變成 `abc`）

#### 預期結果：
```
✅ 開始輸入新字元時，錯誤訊息立即消失
   欄位邊框恢復正常
   （即使長度仍不足 3 個字元，也不會立即顯示錯誤）
   （只有在再次離開欄位時才會重新驗證）
```

---

## 📊 驗證規則總覽

### **登入頁面**

| 欄位 | 驗證規則 | 錯誤訊息 |
|------|---------|---------|
| 電子郵件 | 不能為空 | "電子郵件不能為空" |
| 電子郵件 | 必須是有效格式 | "請提供有效的電子郵件地址" |
| 密碼 | 不能為空 | "密碼不能為空" |

### **註冊頁面**

| 欄位 | 驗證規則 | 錯誤訊息 |
|------|---------|---------|
| 使用者名稱 | 不能為空 | "使用者名稱不能為空" |
| 使用者名稱 | 3-50 個字元 | "使用者名稱長度必須在 3-50 個字元之間" |
| 使用者名稱 | 只能包含 a-z, A-Z, 0-9, _ | "使用者名稱只能包含字母、數字和底線" |
| 電子郵件 | 不能為空 | "電子郵件不能為空" |
| 電子郵件 | 必須是有效格式 | "請提供有效的電子郵件地址" |
| 密碼 | 不能為空 | "密碼不能為空" |
| 密碼 | 至少 8 個字元 | "密碼長度至少需要 8 個字元" |
| 密碼 | 必須包含大寫字母 | "密碼必須包含至少一個大寫字母" |
| 密碼 | 必須包含小寫字母 | "密碼必須包含至少一個小寫字母" |
| 密碼 | 必須包含數字 | "密碼必須包含至少一個數字" |
| 密碼 | 必須包含特殊字元 | "密碼必須包含至少一個特殊字元 (@$!%*?&)" |
| 確認密碼 | 不能為空 | "請確認密碼" |
| 確認密碼 | 必須與密碼一致 | "密碼確認不一致" |

---

## 🎯 技術實現細節

### **前端驗證工具 (`formValidation.ts`)**

位置：`frontend/src/utils/formValidation.ts`

提供以下驗證函數：
- `validateUsername(username: string)`
- `validateEmail(email: string)`
- `validatePassword(password: string, isRegister: boolean)`
- `validateConfirmPassword(password: string, confirmPassword: string)`

每個函數返回：
```typescript
{
  isValid: boolean;
  error?: string;
}
```

### **驗證觸發時機**

1. **onBlur 事件**：當使用者離開欄位時觸發驗證
2. **onChange 事件**：當使用者重新輸入時清除錯誤訊息

### **狀態管理**

```typescript
// 全局錯誤（提交時的後端錯誤）
const [error, setError] = useState<string | null>(null);

// 欄位級錯誤（即時驗證錯誤）
const [fieldErrors, setFieldErrors] = useState<{
  username?: string;
  email?: string;
  password?: string;
  confirmPassword?: string;
}>({});
```

### **TextField 屬性**

```tsx
<TextField
  error={!!fieldErrors.email}        // 顯示錯誤狀態（紅色邊框）
  helperText={fieldErrors.email}     // 顯示錯誤訊息或提示文字
  onBlur={handleBlur}                // 失去焦點時驗證
  onChange={handleChange}            // 輸入時清除錯誤
/>
```

---

## 🌟 使用者體驗優勢

### **1. 即時反饋**
✅ 使用者無需等到提交表單才知道輸入錯誤
✅ 減少挫折感和重複提交次數

### **2. 清晰指引**
✅ 每個欄位都有明確的格式要求說明
✅ 錯誤訊息具體且易懂

### **3. 視覺提示**
✅ 紅色邊框和圖示立即吸引注意
✅ 錯誤訊息位置固定，不會影響頁面佈局

### **4. 智能行為**
✅ 開始輸入時錯誤自動消失
✅ 只在失去焦點時才重新驗證
✅ 不會在輸入過程中不斷跳出錯誤

### **5. 一致性**
✅ 前端驗證規則與後端完全一致
✅ 登入和註冊頁面行為統一

---

## ✅ 驗證完成檢查清單

完整測試以下項目：

- [ ] 登入頁面 - Email 格式錯誤
- [ ] 登入頁面 - Email 為空
- [ ] 登入頁面 - 密碼為空
- [ ] 註冊頁面 - 使用者名稱太短
- [ ] 註冊頁面 - 使用者名稱太長
- [ ] 註冊頁面 - 使用者名稱包含特殊字元
- [ ] 註冊頁面 - Email 格式錯誤
- [ ] 註冊頁面 - 密碼少於 8 字元
- [ ] 註冊頁面 - 密碼缺少大寫字母
- [ ] 註冊頁面 - 密碼缺少小寫字母
- [ ] 註冊頁面 - 密碼缺少數字
- [ ] 註冊頁面 - 密碼缺少特殊字元
- [ ] 註冊頁面 - 確認密碼不一致
- [ ] 錯誤訊息在重新輸入時自動清除
- [ ] 正常輸入時不顯示錯誤
- [ ] 提示文字正確顯示

---

## 🎉 總結

即時表單驗證功能已完整實作，提供了流暢且友善的使用者體驗。使用者可以在填寫表單的過程中立即獲得反饋，大幅提升了註冊和登入流程的易用性。

**現在請刷新前端頁面並按照上述場景測試！** 🚀

