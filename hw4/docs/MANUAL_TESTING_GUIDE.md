# 🧪 前端手動測試指南

## 📋 **測試前準備**

### 1. 確保服務運行

```bash
# 終端機 1: 啟動後端
cd backend
npm run dev

# 終端機 2: 啟動前端
cd frontend
npm run dev
```

確認：
- 後端運行在 `http://localhost:3001`
- 前端運行在 `http://localhost:5173` (或其他端口)

---

## 🧪 **手動測試步驟**

### **測試 1: 首頁**

1. 訪問 `http://localhost:5173`
2. **預期結果**：
   - ✅ 看到美麗的首頁
   - ✅ 顯示「店家/景點探索平台」標題
   - ✅ 看到 4 個功能特色卡片
   - ✅ 看到「立即註冊」和「登入」按鈕

---

### **測試 2: 註冊新使用者**

1. 點擊「立即註冊」按鈕
2. 填寫註冊表單：
   ```
   使用者名稱: testuser123
   電子郵件: testuser123@example.com
   密碼: Test123456!
   確認密碼: Test123456!
   ```
3. 點擊「註冊」按鈕
4. **預期結果**：
   - ✅ 自動跳轉到地點列表頁面 (`/locations`)
   - ✅ 看到「我的地點收藏」標題
   - ✅ 看到「新增地點」和「登出」按鈕
   - ✅ 顯示「還沒有任何地點」訊息

5. **驗證方式**：
   - 打開瀏覽器的開發者工具 (F12)
   - 檢查 `Application` → `Local Storage` → `http://localhost:5173`
   - 應該看到 `auth_token` 鍵值對

---

### **測試 3: 登出**

1. 在地點列表頁面，點擊右上角的「登出」按鈕
2. **預期結果**：
   - ✅ 自動跳轉回首頁
   - ✅ 不再顯示使用者名稱
   - ✅ Local Storage 中的 `auth_token` 被清除

---

### **測試 4: 登入**

1. 在首頁點擊「登入」按鈕
2. 填寫登入表單：
   ```
   電子郵件: testuser123@example.com
   密碼: Test123456!
   ```
3. 點擊「登入」按鈕
4. **預期結果**：
   - ✅ 自動跳轉到地點列表頁面
   - ✅ Local Storage 中再次出現 `auth_token`

---

### **測試 5: 受保護路由**

1. 登出後，嘗試直接訪問 `http://localhost:5173/locations`
2. **預期結果**：
   - ✅ 自動重導向到登入頁面 (`/login`)
   - ✅ 顯示登入表單

---

### **測試 6: 錯誤處理**

#### **測試 6.1: 重複註冊**
1. 使用已註冊的 email 再次註冊
2. **預期結果**：
   - ✅ 顯示錯誤訊息：「Email 已被註冊」或類似訊息

#### **測試 6.2: 錯誤密碼**
1. 使用正確的 email 但錯誤的密碼登入
2. **預期結果**：
   - ✅ 顯示錯誤訊息：「登入失敗，請檢查您的帳號密碼」

#### **測試 6.3: 密碼確認不一致**
1. 在註冊頁面，密碼和確認密碼輸入不同內容
2. **預期結果**：
   - ✅ 顯示錯誤訊息：「密碼確認不一致」

---

### **測試 7: 搜尋功能**

1. 登入後，在地點列表頁面的搜尋框輸入文字
2. **預期結果**：
   - ✅ 即時過濾地點列表（目前為空，所以顯示「找不到符合條件的地點」）

---

## 🧹 **清除測試資料**

### **方法 1: 使用命令清除（推薦）**

```bash
cd backend

# 查看資料庫狀態
npm run db:info

# 清除所有測試資料（保留資料庫結構）
npm run db:clear

# 完整重置並準備測試環境
npm run db:fresh-start

# 初始化資料庫（如果資料庫不存在）
npm run init-db
```

**腳本說明**：
- `db:info` - 查看資料庫狀態和統計資訊
- `db:clear` / `clear-data` - 清除所有資料但保留資料庫結構
- `db:fresh-start` - 重建資料庫並初始化（最徹底的重置）
- `init-db` - 僅初始化資料庫結構（如果資料庫不存在）

### **方法 2: 手動清除瀏覽器資料**

1. 打開瀏覽器開發者工具 (F12)
2. 前往 `Application` 標籤
3. 點擊左側的 `Local Storage`
4. 點擊您的網站 URL
5. 右鍵點擊 → `Clear`
6. 刷新頁面

### **方法 3: 使用無痕模式**

1. 使用瀏覽器的無痕/隱私模式
2. 每次關閉窗口後，所有資料都會自動清除

---

## 🔍 **使用瀏覽器開發者工具**

### **檢查網路請求**

1. 打開開發者工具 (F12)
2. 切換到 `Network` 標籤
3. 執行註冊或登入操作
4. 觀察 API 請求：
   - 請求 URL: `http://localhost:3001/api/auth/register` 或 `/api/auth/login`
   - 請求方法: POST
   - 狀態碼: 200 (成功) 或 4xx/5xx (錯誤)
   - 回應內容: 包含 token 和使用者資料

### **檢查 Console**

1. 切換到 `Console` 標籤
2. 查看是否有任何錯誤訊息
3. 常見錯誤：
   - CORS 錯誤
   - 網路連接錯誤
   - 401 未認證錯誤

### **檢查 Local Storage**

1. 切換到 `Application` 標籤
2. 左側選擇 `Local Storage` → 您的網站 URL
3. 檢查 `auth_token` 是否存在
4. 複製 token 值，可以在 [jwt.io](https://jwt.io) 解碼查看內容

---

## 📊 **完整測試檢查表**

```markdown
### 基本功能
- [ ] 首頁正常顯示
- [ ] 註冊功能正常
- [ ] 登入功能正常
- [ ] 登出功能正常
- [ ] Token 正確儲存和清除

### 錯誤處理
- [ ] 重複 email 註冊被拒絕
- [ ] 錯誤密碼登入失敗
- [ ] 密碼確認不一致提示
- [ ] 未認證訪問受保護路由被重導向

### 使用者體驗
- [ ] 表單驗證即時反饋
- [ ] 載入狀態顯示
- [ ] 錯誤訊息清楚明確
- [ ] 頁面跳轉流暢

### 資料持久性
- [ ] 刷新頁面後仍保持登入狀態
- [ ] Token 存在 Local Storage
- [ ] 關閉瀏覽器後重新打開仍保持登入（除非清除資料）
```

---

## 🚀 **快速測試流程**

```bash
# 1. 清除所有資料，開始全新測試
cd backend

# 選項 A: 完全重建資料庫（推薦用於全新測試）
npm run fresh-start   # 重建並初始化
# 或者
npm run db:rebuild    # 僅重建

# 選項 B: 只清除資料（保留結構，適合快速測試）
npm run db:clear      # 清除資料
# 或者
npm run clear-data    # 別名

# 2. 啟動服務（兩個終端機）
npm run dev           # 終端機 1 (backend)
cd ../frontend && npm run dev  # 終端機 2 (frontend)

# 3. 在瀏覽器執行手動測試

# 4. 執行自動化測試驗證
cd backend
npm run test-frontend

# 5. 測試完成後清除資料
npm run db:clear      # 清除測試資料
npm run db:info       # 確認資料已清除
```

**測試場景建議**：
- **全新功能測試**：使用 `npm run fresh-start`
- **重複測試**：使用 `npm run db:clear`
- **資料庫結構變更後**：使用 `npm run db:rebuild`

---

## 🐛 **常見問題排除**

### **問題 1: 白畫面**
**解決方案**：
- 檢查瀏覽器 Console 是否有錯誤
- 確認前端服務正常運行
- 清除瀏覽器快取並重新整理

### **問題 2: CORS 錯誤**
**解決方案**：
- 確認後端 CORS 設定正確
- 檢查 `backend/.env` 中的 `FRONTEND_URL` 設定
- 重啟後端服務

### **問題 3: 401 未認證錯誤**
**解決方案**：
- 檢查 token 是否存在於 Local Storage
- 確認 token 格式正確（應該是 JWT）
- 嘗試重新登入

### **問題 4: 無法連接後端**
**解決方案**：
- 確認後端服務運行在正確的端口 (3001)
- 檢查防火牆設定
- 檢查 `frontend/.env` 中的 `VITE_API_BASE_URL` 設定

### **問題 5: 資料庫相關錯誤**
**解決方案**：
```bash
cd backend

# 檢查資料庫狀態
npm run db:info

# 如果資料庫損壞，重建資料庫
npm run db:rebuild

# 如果腳本執行失敗，手動檢查
ls -la database/
# 確認 locations.db 檔案存在且可讀寫

# 完全重置（最徹底的解決方案）
npm run fresh-start
```

### **問題 6: npm 腳本找不到**
**解決方案**：
- 確認在 `backend` 目錄下執行命令
- 檢查 `package.json` 中的 scripts 區塊
- 重新安裝依賴：`npm install`

---

## 📝 **測試記錄模板**

```markdown
## 測試日期: YYYY-MM-DD
## 測試人員: [您的名字]

### 測試環境
- 前端 URL: http://localhost:5173
- 後端 URL: http://localhost:3001
- 瀏覽器: Chrome/Firefox/Safari
- 作業系統: macOS/Windows/Linux

### 測試結果
| 功能 | 狀態 | 備註 |
|------|------|------|
| 首頁顯示 | ✅/❌ | |
| 使用者註冊 | ✅/❌ | |
| 使用者登入 | ✅/❌ | |
| 使用者登出 | ✅/❌ | |
| 受保護路由 | ✅/❌ | |
| 錯誤處理 | ✅/❌ | |

### 發現的問題
1. [描述問題]
2. [描述問題]

### 建議改進
1. [改進建議]
2. [改進建議]
```

---

## 🎯 **下一步測試**

當地點管理功能完成後，您可以測試：
- 新增地點
- 編輯地點
- 刪除地點
- 地點搜尋和篩選
- Google Maps 整合

---

## 📋 **資料庫管理腳本總覽**

| 腳本名稱 | 功能 | 使用場景 |
|---------|------|----------|
| `npm run db:info` | 查看資料庫狀態和統計 | 檢查資料庫內容 |
| `npm run db:clear` | 清除所有資料，保留結構 | 快速清除測試資料 |
| `npm run clear-data` | 同上（別名） | 同上 |
| `npm run db:rebuild` | 完全重建資料庫 | 資料庫結構變更後 |
| `npm run reset-db` | 同上（別名） | 同上 |
| `npm run fresh-start` | 重建並初始化資料庫 | 全新測試環境 |
| `npm run init-db` | 初始化資料庫結構 | 首次設置 |

**推薦使用順序**：
1. `npm run fresh-start` - 開始全新測試
2. `npm run db:clear` - 重複測試時清除資料
3. `npm run db:info` - 檢查測試結果

測試愉快！🎉
